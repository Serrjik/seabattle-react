(this["webpackJsonpseabattle-react"]=this["webpackJsonpseabattle-react"]||[]).push([[0],{46:function(e,t,n){},5:function(e,t,n){e.exports={battlefield:"styles_battlefield__fRIp4","battlefield-table":"styles_battlefield-table__eKNBB","battlefield-item":"styles_battlefield-item__vlGdH","battlefield-item__hovered":"styles_battlefield-item__hovered__3oNCD","battlefield-status":"styles_battlefield-status__20FMn",marker:"styles_marker__2TRJF",ship:"styles_ship__1YzKc","ship-killed":"styles_ship-killed__9GLAX",shot:"styles_shot__3Nhoa","shot-missed":"styles_shot-missed__2_MfZ","shot-hitted":"styles_shot-hitted__k_Ot7",dock:"styles_dock__3wC36","battlefield-constructor":"styles_battlefield-constructor__20kD6"}},60:function(e,t,n){"use strict";n.r(t);n(46);var i=n(0),c=n.n(i),r=n(28),o=n.n(r),l=n(4),a=n(1),d=function(){return Object(a.jsx)("p",{children:"BotPage"})},s=n(16),u=n(5),h=n.n(u),f=function(e){var t=e.children,n=e.style,i=void 0===n?{}:n;return Object(a.jsx)("div",{className:h.a.battlefield,style:i,children:t})},p=n(6),j=n(27),b=Object(i.createContext)(),x=function(e){var t=e.cellSize,n=e.children,c=Object(i.useMemo)((function(){return{cellSize:t}}),[t]);return Object(a.jsx)(b.Provider,{value:c,children:n})},y=x;x.defaultProps={cellSize:32};var O=function(){return Object(i.useContext)(b)},g=Object(i.forwardRef)((function(e,t){var n=e.columns,c=e.rows,r=e.signed,o=e.axisX,l=e.axisY,d=O().cellSize,s=Object(i.useMemo)((function(){for(var e=[],t=0;t<c;t++){for(var i=[],r=0;r<n;r++){var o={x:r,y:t};i.push(o)}e.push(i)}return e}),[n,c]);return Object(a.jsx)("table",{ref:t,className:h.a["battlefield-table"],children:Object(a.jsx)("tbody",{children:s.map((function(e,t){return Object(a.jsx)("tr",{children:e.map((function(e,n){var i=null,c=null;return r&&(0===n&&(i=Object(a.jsx)("span",{className:h.a.marker,style:{left:"-".concat(d,"px")},children:o(t)})),0===t&&(c=Object(a.jsx)("span",{className:h.a.marker,style:{top:"-".concat(d,"px")},children:l(n)}))),Object(a.jsxs)("td",{className:h.a["battlefield-item"],style:{width:"".concat(d,"px"),height:"".concat(d,"px")},children:[i,c]},n)}))},t)}))})})})),m=g;g.defaultProps={columns:10,rows:10,signed:!0,axisX:function(e){return e+1},axisY:function(e){return"\u0410\u0411\u0412\u0413\u0414\u0415\u0416\u0417\u0418\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\u0425\u0426\u0427\u0428\u0429\u042b\u042d\u042e\u042f"[e]}};var w=Object(i.forwardRef)((function(e,t){var n=O().cellSize;return Object(a.jsx)("div",{ref:t,className:h.a.dock,style:{width:"".concat(10*n,"px"),height:"".concat(10*n,"px")},children:e.children})})),_=n(66),v=n(15),k=n(29),C=n.n(k),N=Object(i.forwardRef)((function(e,t){var n=e.x,c=e.y,r=e.length,o=e.direction,l=e.killed,d=e.onClick,s=O().cellSize,u=Object(i.useMemo)((function(){var e={},t=r*s+r-1,i=s;"row"===o?(e.width="".concat(t,"px"),e.height="".concat(i,"px")):(e.width="".concat(i,"px"),e.height="".concat(t,"px"));var l=n*(s+1),a=c*(s+1);return e.left="".concat(l,"px"),e.top="".concat(a,"px"),e}),[s,o,r,n,c]);return Object(a.jsx)("div",{onClick:d,ref:t,className:C()(h.a.ship,Object(v.a)({},h.a["ship-killed"],l)),style:u})})),S=N;N.defaultProps={killed:!1};var M=function(e){var t=e.id,n=e.x,i=e.y,c=e.length,r=e.direction,o=e.killed,l=e.onClick,d=Object(_.a)((function(){return{type:"SHIP",item:{id:t},collect:function(e){return{isDragging:e.isDragging()}}}})),s=Object(j.a)(d,2),u=s[0],h=s[1];return u.isDragging?null:Object(a.jsx)(S,{ref:h,onClick:l,killed:o,x:n,y:i,length:c,direction:r})},P=M;M.defaultProps={killed:!1,onclick:function(){}};var z=n(67),R=function(e){var t=e.ships,n=e.onPlace,c=e.onDock,r=e.onRotate,o=Object(i.useMemo)((function(){return t.filter((function(e){return!e.placed}))}),[t]),l=Object(i.useMemo)((function(){return t.filter((function(e){return e.placed}))}),[t]),d=O().cellSize,s=Object(i.useRef)(),u=Object(z.a)((function(){return{accept:"SHIP",drop:function(e){c(e.id)}}})),b=Object(j.a)(u,2)[1],x=Object(z.a)((function(){return{accept:"SHIP",drop:function(e,t){var i=t.getInitialClientOffset(),c=t.getClientOffset(),r=t.getInitialSourceClientOffset(),o=i.x-r.x,l=i.y-r.y,a=s.current.getBoundingClientRect(),u=Math.floor((c.x-a.left-o+d/2)/d),h=Math.floor((c.y-a.top-l+d/2)/d);n(e.id,u,h)}}}));return(0,Object(j.a)(x,2)[1])(s),Object(a.jsxs)("div",{className:h.a["battlefield-constructor"],children:[Object(a.jsx)(w,{ref:b,children:o.map((function(e){return Object(a.jsx)(P,Object(p.a)(Object(p.a)({},e),{},{onClick:function(){return r(e.id)}}),e.id)}))}),Object(a.jsxs)(f,{children:[Object(a.jsx)(m,{ref:s}),l.map((function(e){return Object(a.jsx)(P,Object(p.a)(Object(p.a)({},e),{},{onClick:function(t){return r(e.id,t.clientX,t.clientY,d)}}),e.id)}))]})]})},B=n(26),D=n(40),I=n(20),X=function(e,t){return 0<=e&&e<10&&0<=t&&t<10},F=function(e){var t,n=Array(10).fill().map((function(){return Array(10).fill(0)})),i=Object(B.a)(e);try{for(i.s();!(t=i.n()).done;){for(var c=t.value,r=c.direction,o=c.length,l="row"===r,a="column"===r,d=0;d<o;d++){var s=c.x+d*l,u=c.y+d*a;if(!X(s,u)||n[u][s])return!1}if("row"===r)for(var h=c.y-1;h<=c.y+1;h++)for(var f=c.x-1;f<=c.x+o;f++)X(f,h)&&(n[h][f]=1);else for(var p=c.y-1;p<=c.y+o;p++)for(var j=c.x-1;j<=c.x+1;j++)X(j,p)&&(n[p][j]=1)}}catch(b){i.e(b)}finally{i.f()}return!0},Y=function(){for(var e=[{id:1,x:0,y:0,length:4,direction:"row",placed:!1},{id:2,x:0,y:2,length:3,direction:"row",placed:!1},{id:3,x:4,y:2,length:3,direction:"row",placed:!1},{id:4,x:0,y:4,length:2,direction:"row",placed:!1},{id:5,x:3,y:4,length:2,direction:"row",placed:!1},{id:6,x:6,y:4,length:2,direction:"row",placed:!1},{id:7,x:0,y:6,length:1,direction:"row",placed:!1},{id:8,x:2,y:6,length:1,direction:"row",placed:!1},{id:9,x:4,y:6,length:1,direction:"row",placed:!1},{id:10,x:6,y:6,length:1,direction:"row",placed:!1}],t=0;t<1e5;t++){var n,i=Object(B.a)(e);try{for(i.s();!(n=i.n()).done;){var c=n.value;c.x=Math.floor(10*Math.random()),c.y=Math.floor(10*Math.random()),c.direction=["row","column"][Math.floor(2*Math.random())]}}catch(r){i.e(r)}finally{i.f()}if(F(e))return e}return[{id:1,x:0,y:0,length:4,direction:"row",placed:!1},{id:2,x:0,y:2,length:3,direction:"row",placed:!1},{id:3,x:4,y:2,length:3,direction:"row",placed:!1},{id:4,x:0,y:4,length:2,direction:"row",placed:!1},{id:5,x:3,y:4,length:2,direction:"row",placed:!1},{id:6,x:6,y:4,length:2,direction:"row",placed:!1},{id:7,x:0,y:6,length:1,direction:"row",placed:!1},{id:8,x:2,y:6,length:1,direction:"row",placed:!1},{id:9,x:4,y:6,length:1,direction:"row",placed:!1},{id:10,x:6,y:6,length:1,direction:"row",placed:!1}]},H={ships:[{id:1,x:0,y:0,length:4,direction:"row",placed:!1},{id:2,x:0,y:2,length:3,direction:"row",placed:!1},{id:3,x:4,y:2,length:3,direction:"row",placed:!1},{id:4,x:0,y:4,length:2,direction:"row",placed:!1},{id:5,x:3,y:4,length:2,direction:"row",placed:!1},{id:6,x:6,y:4,length:2,direction:"row",placed:!1},{id:7,x:0,y:6,length:1,direction:"row",placed:!1},{id:8,x:2,y:6,length:1,direction:"row",placed:!1},{id:9,x:4,y:6,length:1,direction:"row",placed:!1},{id:10,x:6,y:6,length:1,direction:"row",placed:!1}]},A=Object(I.b)({name:"editor",initialState:H,reducers:{setShips:function(e,t){e.ships=t.payload},place:function(e,t){var n=t.payload,i=n.id,c=n.x,r=n.y,o=e.ships.filter((function(e){return e.placed&&e.id!==i})),l=e.ships.find((function(e){return e.id===i}));F([].concat(Object(D.a)(o),[Object(p.a)(Object(p.a)({},l),{},{x:c,y:r})]))&&Object.assign(l,{x:c,y:r,placed:!0})},dock:function(e,t){var n=t.payload,i=[{id:1,x:0,y:0,length:4,direction:"row",placed:!1},{id:2,x:0,y:2,length:3,direction:"row",placed:!1},{id:3,x:4,y:2,length:3,direction:"row",placed:!1},{id:4,x:0,y:4,length:2,direction:"row",placed:!1},{id:5,x:3,y:4,length:2,direction:"row",placed:!1},{id:6,x:6,y:4,length:2,direction:"row",placed:!1},{id:7,x:0,y:6,length:1,direction:"row",placed:!1},{id:8,x:2,y:6,length:1,direction:"row",placed:!1},{id:9,x:4,y:6,length:1,direction:"row",placed:!1},{id:10,x:6,y:6,length:1,direction:"row",placed:!1}].find((function(e){return e.id===n})),c=e.ships.find((function(e){return e.id===n}));c&&i&&Object.assign(c,i)},random:function(e){e.ships=Y();var t,n=Object(B.a)(e.ships);try{for(n.s();!(t=n.n()).done;){t.value.placed=!0}}catch(i){n.e(i)}finally{n.f()}},reset:function(e){e.ships=[{id:1,x:0,y:0,length:4,direction:"row",placed:!1},{id:2,x:0,y:2,length:3,direction:"row",placed:!1},{id:3,x:4,y:2,length:3,direction:"row",placed:!1},{id:4,x:0,y:4,length:2,direction:"row",placed:!1},{id:5,x:3,y:4,length:2,direction:"row",placed:!1},{id:6,x:6,y:4,length:2,direction:"row",placed:!1},{id:7,x:0,y:6,length:1,direction:"row",placed:!1},{id:8,x:2,y:6,length:1,direction:"row",placed:!1},{id:9,x:4,y:6,length:1,direction:"row",placed:!1},{id:10,x:6,y:6,length:1,direction:"row",placed:!1}]},rotate:function(e,t){var n=t.payload,i=n.id,c=n.mouseX,r=n.mouseY,o=n.cellSize,l=e.ships.find((function(e){return e.id===i}));if(l&&1!==l.length)if(l.placed){var a=document.querySelector("[class^=styles_ship]:nth-child(".concat(l.id+1,")")).getBoundingClientRect(),d=a.left,s=a.top,u=null,h=null,f=null;"row"===l.direction?((f=Math.floor((c-d)/o))===l.length&&f--,u=l.x+f,h=l.y-f):((f=Math.floor((r-s)/o))===l.length&&f--,u=l.x-f,h=l.y+f);var j=e.ships.filter((function(e){return e.placed&&e.id!==i}));F([].concat(Object(D.a)(j),[Object(p.a)(Object(p.a)({},l),{},{direction:"row"===l.direction?"column":"row",x:u,y:h})]))&&(l.direction="row"===l.direction?"column":"row",l.x=u,l.y=h)}else l.direction="row"===l.direction?"column":"row"}}}),G=A.actions,J=G.place,L=G.dock,T=G.random,E=G.reset,K=G.rotate,Z=G.setShips,q=A.reducer,Q={ships:Y().map((function(e){return Object(p.a)(Object(p.a)({},e),{},{placed:!0})}))},U=Object(I.b)({name:"main",initialState:Q,reducers:{setShips:function(e,t){e.ships=t.payload}}}),V=U.actions.setShips,W=U.reducer,$=n(7),ee=n.n($),te=function(){var e=Object(s.c)((function(e){return e.main.ships})),t=Object(s.c)((function(e){return e.editor.ships})),n=Object(s.b)(),c=Object(l.f)(),r=Object(i.useMemo)((function(){return t.every((function(e){return e.placed}))}),[t]);Object(i.useEffect)((function(){n(Z(e))}),[e,n]);var o=Object(i.useCallback)((function(){n(V(t)),c.push("/")}),[n,c,t]);return Object(a.jsxs)("div",{className:ee.a.container,children:[Object(a.jsx)("div",{className:ee.a["battlefield-constructor"],children:Object(a.jsx)(R,{ships:t,onPlace:function(e,t,i){return n(J({id:e,x:t,y:i}))},onDock:function(e){return n(L(e))},onRotate:function(e,t,i,c){return n(K({id:e,mouseX:t,mouseY:i,cellSize:c}))}})}),Object(a.jsxs)("div",{className:ee.a["editor-actions"],children:[Object(a.jsx)("button",{className:ee.a.action,onClick:function(){return n(E())},children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c"}),Object(a.jsx)("button",{className:ee.a.action,onClick:function(){return n(T())},children:"\u0421\u043b\u0443\u0447\u0430\u0439\u043d\u043e"}),Object(a.jsx)("button",{className:ee.a.action,disabled:!r,onClick:o,children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})},ne=n(17),ie=function(){var e=Object(s.c)((function(e){return e.main.ships}));return Object(a.jsx)("div",{className:ee.a.container,children:Object(a.jsxs)("div",{className:ee.a["main-content"],children:[Object(a.jsxs)(f,{children:[Object(a.jsx)(m,{axisX:function(e){return e+1}}),e.map((function(e){return Object(a.jsx)(S,Object(p.a)({},e),e.id)}))]}),Object(a.jsxs)("div",{className:ee.a["main-actions"],children:[Object(a.jsx)(ne.b,{to:"/editor",children:Object(a.jsx)("button",{className:ee.a.action,children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})}),Object(a.jsx)(ne.b,{to:"/bot",children:Object(a.jsx)("button",{className:ee.a.action,children:"\u0418\u0433\u0440\u0430\u0442\u044c \u0441 \u0431\u043e\u0442\u043e\u043c"})}),Object(a.jsx)("button",{className:ee.a.action,children:"\u0418\u0433\u0440\u0430\u0442\u044c \u043e\u043d\u043b\u0430\u0439\u043d"}),Object(a.jsx)("button",{className:ee.a.action,children:"\u0411\u0440\u043e\u0441\u0438\u0442\u044c \u0432\u044b\u0437\u043e\u0432"})]}),Object(a.jsx)(f,{children:Object(a.jsx)(m,{})})]})})},ce=function(){return Object(a.jsxs)(l.c,{children:[Object(a.jsx)(l.a,{path:"/editor",component:te}),Object(a.jsx)(l.a,{path:"/bot",component:d}),Object(a.jsx)(l.a,{path:"/",component:ie})]})},re=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,68)).then((function(t){var n=t.getCLS,i=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),i(e),c(e),r(e),o(e)}))},oe=n(44),le=n(65),ae=Object(I.a)({reducer:{editor:q,main:W}});o.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(s.a,{store:ae,children:Object(a.jsx)(ne.a,{children:Object(a.jsx)(le.a,{backend:oe.a,children:Object(a.jsx)(y,{cellSize:30,children:Object(a.jsx)(ce,{})})})})})}),document.getElementById("root")),re()},7:function(e,t,n){e.exports={container:"styles_container__1ZoGl","main-content":"styles_main-content__1nsfp","main-actions":"styles_main-actions__2HC0b","editor-actions":"styles_editor-actions__3CX6B",action:"styles_action__1UQw9"}}},[[60,1,2]]]);
//# sourceMappingURL=main.6f157dfc.chunk.js.map