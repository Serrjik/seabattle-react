(this["webpackJsonpseabattle-react"]=this["webpackJsonpseabattle-react"]||[]).push([[0],{46:function(e,t,n){},5:function(e,t,n){e.exports={battlefield:"styles_battlefield__fRIp4","battlefield-table":"styles_battlefield-table__eKNBB","battlefield-item":"styles_battlefield-item__vlGdH","battlefield-item__hovered":"styles_battlefield-item__hovered__3oNCD","battlefield-status":"styles_battlefield-status__20FMn",marker:"styles_marker__2TRJF",ship:"styles_ship__1YzKc","ship-killed":"styles_ship-killed__9GLAX",shot:"styles_shot__3Nhoa","shot-missed":"styles_shot-missed__2_MfZ","shot-hitted":"styles_shot-hitted__k_Ot7",dock:"styles_dock__3wC36","battlefield-constructor":"styles_battlefield-constructor__20kD6"}},60:function(e,t,n){"use strict";n.r(t);n(46);var i=n(0),c=n.n(i),r=n(28),o=n.n(r),a=n(4),l=n(1),d=function(){return Object(l.jsx)("p",{children:"BotPage"})},s=n(16),u=n(5),h=n.n(u),f=function(e){var t=e.children,n=e.style,i=void 0===n?{}:n;return Object(l.jsx)("div",{className:h.a.battlefield,style:i,children:t})},j=n(6),p=n(27),b=Object(i.createContext)(),x=function(e){var t=e.cellSize,n=e.children,c=Object(i.useMemo)((function(){return{cellSize:t}}),[t]);return Object(l.jsx)(b.Provider,{value:c,children:n})},y=x;x.defaultProps={cellSize:32};var O=function(){return Object(i.useContext)(b)},g=Object(i.forwardRef)((function(e,t){var n=e.columns,c=e.rows,r=e.signed,o=e.axisX,a=e.axisY,d=O().cellSize,s=Object(i.useMemo)((function(){for(var e=[],t=0;t<c;t++){for(var i=[],r=0;r<n;r++){var o={x:r,y:t};i.push(o)}e.push(i)}return e}),[n,c]);return Object(l.jsx)("table",{ref:t,className:h.a["battlefield-table"],children:Object(l.jsx)("tbody",{children:s.map((function(e,t){return Object(l.jsx)("tr",{children:e.map((function(e,n){var i=null,c=null;return r&&(0===n&&(i=Object(l.jsx)("span",{className:h.a.marker,style:{left:"-".concat(d,"px")},children:o(t)})),0===t&&(c=Object(l.jsx)("span",{className:h.a.marker,style:{top:"-".concat(d,"px")},children:a(n)}))),Object(l.jsxs)("td",{className:h.a["battlefield-item"],style:{width:"".concat(d,"px"),height:"".concat(d,"px")},children:[i,c]},n)}))},t)}))})})})),m=g;g.defaultProps={columns:10,rows:10,signed:!0,axisX:function(e){return e+1},axisY:function(e){return"\u0410\u0411\u0412\u0413\u0414\u0415\u0416\u0417\u0418\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\u0425\u0426\u0427\u0428\u0429\u042b\u042d\u042e\u042f"[e]}};var w=Object(i.forwardRef)((function(e,t){var n=O().cellSize;return Object(l.jsx)("div",{ref:t,className:h.a.dock,style:{width:"".concat(10*n,"px"),height:"".concat(10*n,"px")},children:e.children})})),_=n(66),v=n(15),k=n(29),N=n.n(k),C=Object(i.forwardRef)((function(e,t){var n=e.x,c=e.y,r=e.length,o=e.direction,a=e.killed,d=e.onClick,s=O().cellSize,u=Object(i.useMemo)((function(){var e={},t=r*s+r-1,i=s;"row"===o?(e.width="".concat(t,"px"),e.height="".concat(i,"px")):(e.width="".concat(i,"px"),e.height="".concat(t,"px"));var a=n*(s+1),l=c*(s+1);return e.left="".concat(a,"px"),e.top="".concat(l,"px"),e}),[s,o,r,n,c]);return Object(l.jsx)("div",{onClick:d,ref:t,className:N()(h.a.ship,Object(v.a)({},h.a["ship-killed"],a)),style:u})})),S=C;C.defaultProps={killed:!1};var M=function(e){var t=e.id,n=e.x,i=e.y,c=e.length,r=e.direction,o=e.killed,a=e.onClick,d=Object(_.a)((function(){return{type:"SHIP",item:{id:t},collect:function(e){return{isDragging:e.isDragging()}}}})),s=Object(p.a)(d,2),u=s[0],h=s[1];return u.isDragging?null:Object(l.jsx)(S,{ref:h,onClick:a,killed:o,x:n,y:i,length:c,direction:r})},P=M;M.defaultProps={killed:!1,onclick:function(){}};var z=n(67),R=function(e){var t=e.ships,n=e.onPlace,c=e.onDock,r=e.onRotate,o=Object(i.useMemo)((function(){return t.filter((function(e){return!e.placed}))}),[t]),a=Object(i.useMemo)((function(){return t.filter((function(e){return e.placed}))}),[t]),d=O().cellSize,s=Object(i.useRef)(),u=Object(z.a)((function(){return{accept:"SHIP",drop:function(e){c(e.id)}}})),b=Object(p.a)(u,2)[1],x=Object(z.a)((function(){return{accept:"SHIP",drop:function(e,t){var i=t.getInitialClientOffset(),c=t.getClientOffset(),r=t.getInitialSourceClientOffset(),o=i.x-r.x,a=i.y-r.y,l=s.current.getBoundingClientRect(),u=Math.floor((c.x-l.left-o+d/2)/d),h=Math.floor((c.y-l.top-a+d/2)/d);n(e.id,u,h)}}}));return(0,Object(p.a)(x,2)[1])(s),Object(l.jsxs)("div",{className:h.a["battlefield-constructor"],children:[Object(l.jsx)(w,{ref:b,children:o.map((function(e){return Object(l.jsx)(P,Object(j.a)(Object(j.a)({},e),{},{onClick:function(){return r(e.id)}}),e.id)}))}),Object(l.jsxs)(f,{children:[Object(l.jsx)(m,{ref:s}),a.map((function(e){return Object(l.jsx)(P,Object(j.a)(Object(j.a)({},e),{},{onClick:function(){return r(e.id)}}),e.id)}))]})]})},D=n(26),I=n(40),B=n(20),F=function(e,t){return 0<=e&&e<10&&0<=t&&t<10},H=function(e){var t,n=Array(10).fill().map((function(){return Array(10).fill(0)})),i=Object(D.a)(e);try{for(i.s();!(t=i.n()).done;){for(var c=t.value,r=c.direction,o=c.length,a="row"===r,l="column"===r,d=0;d<o;d++){var s=c.x+d*a,u=c.y+d*l;if(!F(s,u)||n[u][s])return!1}if("row"===r)for(var h=c.y-1;h<=c.y+1;h++)for(var f=c.x-1;f<=c.x+o;f++)F(f,h)&&(n[h][f]=1);else for(var j=c.y-1;j<=c.y+o;j++)for(var p=c.x-1;p<=c.x+1;p++)F(p,j)&&(n[j][p]=1)}}catch(b){i.e(b)}finally{i.f()}return!0},X=function(){for(var e=[{id:1,x:0,y:0,length:4,direction:"row",placed:!1},{id:2,x:0,y:2,length:3,direction:"row",placed:!1},{id:3,x:4,y:2,length:3,direction:"row",placed:!1},{id:4,x:0,y:4,length:2,direction:"row",placed:!1},{id:5,x:3,y:4,length:2,direction:"row",placed:!1},{id:6,x:6,y:4,length:2,direction:"row",placed:!1},{id:7,x:0,y:6,length:1,direction:"row",placed:!1},{id:8,x:2,y:6,length:1,direction:"row",placed:!1},{id:9,x:4,y:6,length:1,direction:"row",placed:!1},{id:10,x:6,y:6,length:1,direction:"row",placed:!1}],t=0;t<1e5;t++){var n,i=Object(D.a)(e);try{for(i.s();!(n=i.n()).done;){var c=n.value;c.x=Math.floor(10*Math.random()),c.y=Math.floor(10*Math.random()),c.direction=["row","column"][Math.floor(2*Math.random())]}}catch(r){i.e(r)}finally{i.f()}if(H(e))return e}return[{id:1,x:0,y:0,length:4,direction:"row",placed:!1},{id:2,x:0,y:2,length:3,direction:"row",placed:!1},{id:3,x:4,y:2,length:3,direction:"row",placed:!1},{id:4,x:0,y:4,length:2,direction:"row",placed:!1},{id:5,x:3,y:4,length:2,direction:"row",placed:!1},{id:6,x:6,y:4,length:2,direction:"row",placed:!1},{id:7,x:0,y:6,length:1,direction:"row",placed:!1},{id:8,x:2,y:6,length:1,direction:"row",placed:!1},{id:9,x:4,y:6,length:1,direction:"row",placed:!1},{id:10,x:6,y:6,length:1,direction:"row",placed:!1}]},A={ships:[{id:1,x:0,y:0,length:4,direction:"row",placed:!1},{id:2,x:0,y:2,length:3,direction:"row",placed:!1},{id:3,x:4,y:2,length:3,direction:"row",placed:!1},{id:4,x:0,y:4,length:2,direction:"row",placed:!1},{id:5,x:3,y:4,length:2,direction:"row",placed:!1},{id:6,x:6,y:4,length:2,direction:"row",placed:!1},{id:7,x:0,y:6,length:1,direction:"row",placed:!1},{id:8,x:2,y:6,length:1,direction:"row",placed:!1},{id:9,x:4,y:6,length:1,direction:"row",placed:!1},{id:10,x:6,y:6,length:1,direction:"row",placed:!1}]},G=Object(B.b)({name:"editor",initialState:A,reducers:{setShips:function(e,t){e.ships=t.payload},place:function(e,t){var n=t.payload,i=n.id,c=n.x,r=n.y,o=e.ships.filter((function(e){return e.placed&&e.id!==i})),a=e.ships.find((function(e){return e.id===i}));H([].concat(Object(I.a)(o),[Object(j.a)(Object(j.a)({},a),{},{x:c,y:r})]))&&Object.assign(a,{x:c,y:r,placed:!0})},dock:function(e,t){var n=t.payload,i=[{id:1,x:0,y:0,length:4,direction:"row",placed:!1},{id:2,x:0,y:2,length:3,direction:"row",placed:!1},{id:3,x:4,y:2,length:3,direction:"row",placed:!1},{id:4,x:0,y:4,length:2,direction:"row",placed:!1},{id:5,x:3,y:4,length:2,direction:"row",placed:!1},{id:6,x:6,y:4,length:2,direction:"row",placed:!1},{id:7,x:0,y:6,length:1,direction:"row",placed:!1},{id:8,x:2,y:6,length:1,direction:"row",placed:!1},{id:9,x:4,y:6,length:1,direction:"row",placed:!1},{id:10,x:6,y:6,length:1,direction:"row",placed:!1}].find((function(e){return e.id===n})),c=e.ships.find((function(e){return e.id===n}));c&&i&&Object.assign(c,i)},random:function(e){e.ships=X();var t,n=Object(D.a)(e.ships);try{for(n.s();!(t=n.n()).done;){t.value.placed=!0}}catch(i){n.e(i)}finally{n.f()}},reset:function(e){e.ships=[{id:1,x:0,y:0,length:4,direction:"row",placed:!1},{id:2,x:0,y:2,length:3,direction:"row",placed:!1},{id:3,x:4,y:2,length:3,direction:"row",placed:!1},{id:4,x:0,y:4,length:2,direction:"row",placed:!1},{id:5,x:3,y:4,length:2,direction:"row",placed:!1},{id:6,x:6,y:4,length:2,direction:"row",placed:!1},{id:7,x:0,y:6,length:1,direction:"row",placed:!1},{id:8,x:2,y:6,length:1,direction:"row",placed:!1},{id:9,x:4,y:6,length:1,direction:"row",placed:!1},{id:10,x:6,y:6,length:1,direction:"row",placed:!1}]},rotate:function(e,t){var n=t.payload,i=e.ships.find((function(e){return e.id===n}));if(i)if(i.placed){var c=e.ships.filter((function(e){return e.placed&&e.id!==n}));H([].concat(Object(I.a)(c),[Object(j.a)(Object(j.a)({},i),{},{direction:"row"===i.direction?"column":"row"})]))&&(i.direction="row"===i.direction?"column":"row")}else i.direction="row"===i.direction?"column":"row"}}}),J=G.actions,L=J.place,T=J.dock,Y=J.random,E=J.reset,K=J.rotate,Z=J.setShips,Q=G.reducer,U={ships:X().map((function(e){return Object(j.a)(Object(j.a)({},e),{},{placed:!0})}))},q=Object(B.b)({name:"main",initialState:U,reducers:{setShips:function(e,t){e.ships=t.payload}}}),V=q.actions.setShips,W=q.reducer,$=n(7),ee=n.n($),te=function(){var e=Object(s.c)((function(e){return e.main.ships})),t=Object(s.c)((function(e){return e.editor.ships})),n=Object(s.b)(),c=Object(a.f)(),r=Object(i.useMemo)((function(){return t.every((function(e){return e.placed}))}),[t]);Object(i.useEffect)((function(){n(Z(e))}),[e,n]);var o=Object(i.useCallback)((function(){n(V(t)),c.push("/")}),[n,c,t]);return Object(l.jsxs)("div",{className:ee.a.container,children:[Object(l.jsx)("div",{className:ee.a["battlefield-constructor"],children:Object(l.jsx)(R,{ships:t,onPlace:function(e,t,i){return n(L({id:e,x:t,y:i}))},onDock:function(e){return n(T(e))},onRotate:function(e){return n(K(e))}})}),Object(l.jsxs)("div",{className:ee.a["editor-actions"],children:[Object(l.jsx)("button",{className:ee.a.action,onClick:function(){return n(E())},children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c"}),Object(l.jsx)("button",{className:ee.a.action,onClick:function(){return n(Y())},children:"\u0421\u043b\u0443\u0447\u0430\u0439\u043d\u043e"}),Object(l.jsx)("button",{className:ee.a.action,disabled:!r,onClick:o,children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]})},ne=n(17),ie=function(){var e=Object(s.c)((function(e){return e.main.ships}));return Object(l.jsx)("div",{className:ee.a.container,children:Object(l.jsxs)("div",{className:ee.a["main-content"],children:[Object(l.jsxs)(f,{children:[Object(l.jsx)(m,{axisX:function(e){return e+1}}),e.map((function(e){return Object(l.jsx)(S,Object(j.a)({},e),e.id)}))]}),Object(l.jsxs)("div",{className:ee.a["main-actions"],children:[Object(l.jsx)(ne.b,{to:"/editor",children:Object(l.jsx)("button",{className:ee.a.action,children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})}),Object(l.jsx)(ne.b,{to:"/bot",children:Object(l.jsx)("button",{className:ee.a.action,children:"\u0418\u0433\u0440\u0430\u0442\u044c \u0441 \u0431\u043e\u0442\u043e\u043c"})}),Object(l.jsx)("button",{className:ee.a.action,children:"\u0418\u0433\u0440\u0430\u0442\u044c \u043e\u043d\u043b\u0430\u0439\u043d"}),Object(l.jsx)("button",{className:ee.a.action,children:"\u0411\u0440\u043e\u0441\u0438\u0442\u044c \u0432\u044b\u0437\u043e\u0432"})]}),Object(l.jsx)(f,{children:Object(l.jsx)(m,{})})]})})},ce=function(){return Object(l.jsxs)(a.c,{children:[Object(l.jsx)(a.a,{path:"/editor",component:te}),Object(l.jsx)(a.a,{path:"/bot",component:d}),Object(l.jsx)(a.a,{path:"/",component:ie})]})},re=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,68)).then((function(t){var n=t.getCLS,i=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),i(e),c(e),r(e),o(e)}))},oe=n(44),ae=n(65),le=Object(B.a)({reducer:{editor:Q,main:W}});o.a.render(Object(l.jsx)(c.a.StrictMode,{children:Object(l.jsx)(s.a,{store:le,children:Object(l.jsx)(ne.a,{children:Object(l.jsx)(ae.a,{backend:oe.a,children:Object(l.jsx)(y,{cellSize:30,children:Object(l.jsx)(ce,{})})})})})}),document.getElementById("root")),re()},7:function(e,t,n){e.exports={container:"styles_container__1ZoGl","main-content":"styles_main-content__1nsfp","main-actions":"styles_main-actions__2HC0b","editor-actions":"styles_editor-actions__3CX6B",action:"styles_action__1UQw9"}}},[[60,1,2]]]);
//# sourceMappingURL=main.c6ac0053.chunk.js.map